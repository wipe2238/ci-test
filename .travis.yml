os: linux
sudo: required
notifications:
 email: false

git:
 depth: false
 checkout:
  - git clone

language: cpp
env:
 - GXX=4.8
 - GXX=4.9
 - GXX=5
 - GXX=6
 - GXX=7
 - GXX=8

matrix:
 allow_failures:
  - env: GXX=8

cache:
 apt: true
 directories:
  - cache

before_install:
 - export CC=gcc-${GXX} CXX=g++-${GXX}
 - sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
 - sudo apt-get update
 - sudo apt-get install -qq ${CC}-multilib ${CXX}-multilib

install:
 - PATH=cache/cmake/bin:$PATH
 - cmake -DO=CMakeBuild.cmake -DOWNLOAD_DIR=cache -P cmake/SelfUpdate/SelfUpdate.cmake && hash -r

script:
 - cmake -P CMakeBuild.cmake
